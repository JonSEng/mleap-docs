
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Transforming a Leap Frame Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../advanced/" />
    
    
    <link rel="prev" href="storing.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    MLeap Documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../getting-started/mleap.html">
            
                <a href="../getting-started/mleap.html">
            
                    
                    Getting Started with MLeap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../getting-started/spark.html">
            
                <a href="../getting-started/spark.html">
            
                    
                    Getting Started with Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../getting-started/py-spark.html">
            
                <a href="../getting-started/py-spark.html">
            
                    
                    Getting Started with PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../getting-started/scikit-learn.html">
            
                <a href="../getting-started/scikit-learn.html">
            
                    
                    Getting Started with Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="../getting-started/tensorflow.html">
            
                <a href="../getting-started/tensorflow.html">
            
                    
                    Getting Started with Tensorflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="../getting-started/building.html">
            
                <a href="../getting-started/building.html">
            
                    
                    Building from Source
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../core-concepts/">
            
                <a href="../core-concepts/">
            
                    
                    Core Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../core-concepts/data-frames/">
            
                <a href="../core-concepts/data-frames/">
            
                    
                    Data Frames
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../core-concepts/data-frames/data-types.html">
            
                <a href="../core-concepts/data-frames/data-types.html">
            
                    
                    Data Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../core-concepts/transformers/">
            
                <a href="../core-concepts/transformers/">
            
                    
                    Transformers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../core-concepts/transformers/support.html">
            
                <a href="../core-concepts/transformers/support.html">
            
                    
                    Supported Transformers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../core-concepts/pipelines.html">
            
                <a href="../core-concepts/pipelines.html">
            
                    
                    Pipelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../core-concepts/mleap-bundles.html">
            
                <a href="../core-concepts/mleap-bundles.html">
            
                    
                    MLeap Bundles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../core-concepts/mleap-runtime.html">
            
                <a href="../core-concepts/mleap-runtime.html">
            
                    
                    MLeap Runtime
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    Basic Usage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="create-leap-frame.html">
            
                <a href="create-leap-frame.html">
            
                    
                    Creating a Leap Frame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="leap-frame-operations.html">
            
                <a href="leap-frame-operations.html">
            
                    
                    Leap Frame Operations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="leap-frame-operations.html">
            
                <a href="leap-frame-operations.html#insert">
            
                    
                    Insert
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="leap-frame-operations.html">
            
                <a href="leap-frame-operations.html#drop">
            
                    
                    Drop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="leap-frame-operations.html">
            
                <a href="leap-frame-operations.html#read">
            
                    
                    Read
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="leap-frame-operations.html">
            
                <a href="leap-frame-operations.html#select">
            
                    
                    Select
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="storing.html">
            
                <a href="storing.html">
            
                    
                    Storing a Leap Frame
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="storing.html">
            
                <a href="storing.html#json">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="storing.html">
            
                <a href="storing.html#avro">
            
                    
                    Avro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="storing.html">
            
                <a href="storing.html#binary">
            
                    
                    Binary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="storing.html">
            
                <a href="storing.html#custom">
            
                    
                    Custom
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3.4" data-path="transform-leap-frame.html">
            
                <a href="transform-leap-frame.html">
            
                    
                    Transforming a Leap Frame
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    Advanced Usage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../advanced/row-transformer.html">
            
                <a href="../advanced/row-transformer.html">
            
                    
                    Row Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../advanced/custom-transformer.html">
            
                <a href="../advanced/custom-transformer.html">
            
                    
                    Custom Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../advanced/custom-data-type.html">
            
                <a href="../advanced/custom-data-type.html">
            
                    
                    Custom Data Type
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mleap-bundle/">
            
                <a href="../mleap-bundle/">
            
                    
                    MLeap Bundles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../mleap-bundle/mleap.html">
            
                <a href="../mleap-bundle/mleap.html">
            
                    
                    MLeap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../mleap-bundle/spark.html">
            
                <a href="../mleap-bundle/spark.html">
            
                    
                    Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../mleap-bundle/py-spark.html">
            
                <a href="../mleap-bundle/py-spark.html">
            
                    
                    PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../mleap-bundle/scikit-learn.html">
            
                <a href="../mleap-bundle/scikit-learn.html">
            
                    
                    Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../mleap-bundle/tensorflow.html">
            
                <a href="../mleap-bundle/tensorflow.html">
            
                    
                    Tensorflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../integration/">
            
                <a href="../integration/">
            
                    
                    Integration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../integration/spark.html">
            
                <a href="../integration/spark.html">
            
                    
                    Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../integration/py-spark.html">
            
                <a href="../integration/py-spark.html">
            
                    
                    PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../integration/scikit-learn.html">
            
                <a href="../integration/scikit-learn.html">
            
                    
                    Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../integration/tensorflow/">
            
                <a href="../integration/tensorflow/">
            
                    
                    Tensorflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="../integration/tensorflow/mleap-transformer.html">
            
                <a href="../integration/tensorflow/mleap-transformer.html">
            
                    
                    MLeap Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="../integration/tensorflow/bundle-serialization.html">
            
                <a href="../integration/tensorflow/bundle-serialization.html">
            
                    
                    Bundle Serialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="../integration/tensorflow/usage.html">
            
                <a href="../integration/tensorflow/usage.html">
            
                    
                    Using Tensorflow Graphs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../integration/databricks-notebooks.html">
            
                <a href="../integration/databricks-notebooks.html">
            
                    
                    Databricks Notebooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../integration/zeppelin-notebooks.html">
            
                <a href="../integration/zeppelin-notebooks.html">
            
                    
                    Zeppelin Notebooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../integration/jupyter-notebooks.html">
            
                <a href="../integration/jupyter-notebooks.html">
            
                    
                    Jupyter Notebooks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Transforming a Leap Frame</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="transforming-a-leap-frame">Transforming a Leap Frame</h1>
<p>Transformers are a useful abstraction for computing data in a data
frame, whether it is a leap frame in MLeap or a Spark data frame. Let&apos;s
see how to transform a data frame using a simple <code>StringIndexer</code>
transformer.</p>
<pre><code class="lang-scala"><span class="hljs-comment">// Create a StringIndexer that knows how to index the two strings</span>
<span class="hljs-comment">// In our leap frame</span>
<span class="hljs-keyword">val</span> stringIndexer = <span class="hljs-type">StringIndexer</span>(inputCol = <span class="hljs-string">&quot;a_string&quot;</span>,
  outputCol = <span class="hljs-string">&quot;a_string_index&quot;</span>,
  model = <span class="hljs-type">StringIndexerModel</span>(<span class="hljs-type">Seq</span>(<span class="hljs-string">&quot;Hello, MLeap!&quot;</span>, <span class="hljs-string">&quot;Another row&quot;</span>)))

<span class="hljs-comment">// Transform our leap frame using the StringIndexer transformer</span>
<span class="hljs-keyword">val</span> indices = (<span class="hljs-keyword">for</span>(lf &lt;- stringIndexer.transform(leapFrame);
                   lf2 &lt;- lf.select(<span class="hljs-string">&quot;a_string_index&quot;</span>)) <span class="hljs-keyword">yield</span> {
  lf2.dataset.map(_.getDouble(<span class="hljs-number">0</span>))
}).get.toSeq

<span class="hljs-comment">// Make sure our indexer did its job</span>
assert(indices == <span class="hljs-type">Seq</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>))
</code></pre>
<h2 id="transforming-a-leap-frame-with-a-pipeline">Transforming a Leap Frame with a Pipeline</h2>
<p>The above example isn&apos;t very interesting. The real power of data frames
and transformers comes when you build entire pipelines out of them,
going all the way from raw features to some sort of predictive
algorithm. Let&apos;s create a dummy pipeline that takes our indices from the
string indexer, runs them through a one hot encoder, then executes a
linear regression.</p>
<pre><code class="lang-scala"><span class="hljs-comment">// Create our one hot encoder</span>
<span class="hljs-keyword">val</span> oneHotEncoder = <span class="hljs-type">OneHotEncoder</span>(inputCol = <span class="hljs-string">&quot;a_string_index&quot;</span>,
  outputCol = <span class="hljs-string">&quot;a_string_oh&quot;</span>,
  model = <span class="hljs-type">OneHotEncoderModel</span>(<span class="hljs-number">2</span>, dropLast = <span class="hljs-literal">false</span>))

<span class="hljs-comment">// Assemble some features together for use</span>
<span class="hljs-comment">// By our linear regression</span>
<span class="hljs-keyword">val</span> featureAssembler = <span class="hljs-type">VectorAssembler</span>(inputCols = <span class="hljs-type">Array</span>(oneHotEncoder.outputCol, <span class="hljs-string">&quot;a_double&quot;</span>),
  outputCol = <span class="hljs-string">&quot;features&quot;</span>)

<span class="hljs-comment">// Create our linear regression</span>
<span class="hljs-comment">// It has two coefficients, as the one hot encoder</span>
<span class="hljs-comment">// Outputs vectors of size 2</span>
<span class="hljs-keyword">val</span> linearRegression = <span class="hljs-type">LinearRegression</span>(featuresCol = featureAssembler.outputCol,
  predictionCol = <span class="hljs-string">&quot;prediction&quot;</span>,
  model = <span class="hljs-type">LinearRegressionModel</span>(<span class="hljs-type">Vectors</span>.dense(<span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>), <span class="hljs-number">23.5</span>))

<span class="hljs-comment">// Create a pipeline from all of our transformers</span>
<span class="hljs-keyword">val</span> pipeline = <span class="hljs-type">Pipeline</span>(transformers = <span class="hljs-type">Seq</span>(stringIndexer, oneHotEncoder, featureAssembler, linearRegression))

<span class="hljs-comment">// Transform our leap frame using the pipeline</span>
<span class="hljs-keyword">val</span> predictions = (<span class="hljs-keyword">for</span>(lf &lt;- pipeline.transform(leapFrame);
                       lf2 &lt;- lf.select(<span class="hljs-string">&quot;prediction&quot;</span>)) <span class="hljs-keyword">yield</span> {
  lf2.dataset.map(_.getDouble(<span class="hljs-number">0</span>))
}).get.toSeq

<span class="hljs-comment">// Print our predictions</span>
<span class="hljs-comment">//   &gt; 365.70000000000005</span>
<span class="hljs-comment">//   &gt; 166.89999999999998</span>
println(predictions.mkString(<span class="hljs-string">&quot;\n&quot;</span>))
</code></pre>
<p>This is the task that MLeap was meant for, executing machine learning
pipelines that were trained in Spark, PySpark, Scikit-learn or
Tensorflow.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="storing.html#custom" class="navigation navigation-prev " aria-label="Previous page: Custom">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../advanced/" class="navigation navigation-next " aria-label="Next page: Advanced Usage">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Transforming a Leap Frame","level":"1.3.4","depth":2,"next":{"title":"Advanced Usage","level":"1.4","depth":1,"path":"advanced/index.md","ref":"advanced/index.md","articles":[{"title":"Row Transformer","level":"1.4.1","depth":2,"path":"advanced/row-transformer.md","ref":"advanced/row-transformer.md","articles":[]},{"title":"Custom Transformer","level":"1.4.2","depth":2,"path":"advanced/custom-transformer.md","ref":"advanced/custom-transformer.md","articles":[]},{"title":"Custom Data Type","level":"1.4.3","depth":2,"path":"advanced/custom-data-type.md","ref":"advanced/custom-data-type.md","articles":[]}]},"previous":{"title":"Custom","level":"1.3.3.4","depth":3,"anchor":"#custom","path":"basic/storing.md","ref":"basic/storing.md#custom","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"basic/transform-leap-frame.md","mtime":"2017-01-17T02:00:38.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-17T08:01:06.036Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

