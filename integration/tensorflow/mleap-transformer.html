
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>MLeap Transformer Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="bundle-serialization.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    MLeap Documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../../why.html">
            
                <a href="../../why.html">
            
                    
                    Why Mleap?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../../getting-started/">
            
                <a href="../../getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../../getting-started/mleap.html">
            
                <a href="../../getting-started/mleap.html">
            
                    
                    Getting Started with MLeap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../../getting-started/spark.html">
            
                <a href="../../getting-started/spark.html">
            
                    
                    Getting Started with Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../../getting-started/py-spark.html">
            
                <a href="../../getting-started/py-spark.html">
            
                    
                    Getting Started with PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="../../getting-started/scikit-learn.html">
            
                <a href="../../getting-started/scikit-learn.html">
            
                    
                    Getting Started with Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="../../getting-started/tensorflow.html">
            
                <a href="../../getting-started/tensorflow.html">
            
                    
                    Getting Started with Tensorflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.8" data-path="../../getting-started/building.html">
            
                <a href="../../getting-started/building.html">
            
                    
                    Building from Source
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../core-concepts/">
            
                <a href="../../core-concepts/">
            
                    
                    Core Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../core-concepts/data-frames/">
            
                <a href="../../core-concepts/data-frames/">
            
                    
                    Data Frames
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../core-concepts/data-frames/data-types.html">
            
                <a href="../../core-concepts/data-frames/data-types.html">
            
                    
                    Data Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../core-concepts/transformers/">
            
                <a href="../../core-concepts/transformers/">
            
                    
                    Transformers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../core-concepts/transformers/support.html">
            
                <a href="../../core-concepts/transformers/support.html">
            
                    
                    Supported Transformers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../core-concepts/pipelines.html">
            
                <a href="../../core-concepts/pipelines.html">
            
                    
                    Pipelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../core-concepts/mleap-bundles.html">
            
                <a href="../../core-concepts/mleap-bundles.html">
            
                    
                    MLeap Bundles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../core-concepts/mleap-runtime.html">
            
                <a href="../../core-concepts/mleap-runtime.html">
            
                    
                    MLeap Runtime
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../basic/">
            
                <a href="../../basic/">
            
                    
                    Basic Usage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../basic/create-leap-frame.html">
            
                <a href="../../basic/create-leap-frame.html">
            
                    
                    Creating a Leap Frame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../basic/insert-values-leap-frame.html">
            
                <a href="../../basic/insert-values-leap-frame.html">
            
                    
                    Inserting Into a Leap Frame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../basic/transform-leap-frame.html">
            
                <a href="../../basic/transform-leap-frame.html">
            
                    
                    Transforming a Leap Frame
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../advanced/">
            
                <a href="../../advanced/">
            
                    
                    Advanced Usage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../advanced/row-transformer.html">
            
                <a href="../../advanced/row-transformer.html">
            
                    
                    Row Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../advanced/custom-transformer.html">
            
                <a href="../../advanced/custom-transformer.html">
            
                    
                    Custom Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../advanced/custom-data-type.html">
            
                <a href="../../advanced/custom-data-type.html">
            
                    
                    Custom Data Type
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../mleap-bundle/">
            
                <a href="../../mleap-bundle/">
            
                    
                    MLeap Bundles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../mleap-bundle/mleap.html">
            
                <a href="../../mleap-bundle/mleap.html">
            
                    
                    MLeap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../mleap-bundle/spark.html">
            
                <a href="../../mleap-bundle/spark.html">
            
                    
                    Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../mleap-bundle/py-spark.html">
            
                <a href="../../mleap-bundle/py-spark.html">
            
                    
                    PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../../mleap-bundle/scikit-learn.html">
            
                <a href="../../mleap-bundle/scikit-learn.html">
            
                    
                    Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../../mleap-bundle/tensorflow.html">
            
                <a href="../../mleap-bundle/tensorflow.html">
            
                    
                    Tensorflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../">
            
                <a href="../">
            
                    
                    Integration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../spark.html">
            
                <a href="../spark.html">
            
                    
                    Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../py-spark.html">
            
                <a href="../py-spark.html">
            
                    
                    PySpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../scikit-learn.html">
            
                <a href="../scikit-learn.html">
            
                    
                    Scikit-learn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="./">
            
                <a href="./">
            
                    
                    Tensorflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.4.1" data-path="mleap-transformer.html">
            
                <a href="mleap-transformer.html">
            
                    
                    MLeap Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="bundle-serialization.html">
            
                <a href="bundle-serialization.html">
            
                    
                    Bundle Serialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="usage.html">
            
                <a href="usage.html">
            
                    
                    Exporting Models
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../databricks-notebooks.html">
            
                <a href="../databricks-notebooks.html">
            
                    
                    Databricks Notebooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../zeppelin-notebooks.html">
            
                <a href="../zeppelin-notebooks.html">
            
                    
                    Zeppelin Notebooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../jupyter-notebooks.html">
            
                <a href="../jupyter-notebooks.html">
            
                    
                    Jupyter Notebooks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >MLeap Transformer</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="tensorflow-mleap-transformer">Tensorflow MLeap Transformer</h1>
<p>MLeap supports integration with pre-trained Tensorflow graphs. MLeap uses the Swig bindings provided with Tensorflow to call down to Tensorflow C++ libraries after converting from MLeap data types to the required C++ tensor types.</p>
<h2 id="mleap-tensorflow-transformer">MLeap Tensorflow Transformer</h2>
<p>The MLeap Tensorflow transformer is built with a Tensorflow graph file that was saved using the <code>freeze_graph</code> function. When the transformer lazily initializes a Tensorflow sessions on the first request to transform a leap frame. Once the sessions is started, it remains open until the <code>close</code> method is called on the MLeap Tensorflow transformer.</p>
<p>The data in the LeapFrame should be in the proper format when handed to the Tensorflow transformer, so that the proper conversions to Tensorflow data types occurs. See the <a href="#type-conversions">Type Conversions</a> section for how converting to Tensorflow types works.</p>
<p>The transformer then outputs a list of tensors as the raw Tensorflow output field, along with individual columns for all output tensors specified. The intermediate output list is needed because of the way MLeap works currently, but we may get rid of it in the future. See <a href="#example">Example</a> for an example of how a Tensorflow graph can be executed against a LeapFrame. The output types of the tensors are needed ahead of time so that we know how to form the new LeapFrame after transforming.</p>
<h3 id="mleap-tensorflow-model">MLeap Tensorflow Model</h3>
<p>The model is responsible for maintaining the Tensorflow session. It is a Java <code>Closeable</code> and needs to be closed when the MLeap transformer or other controlling object no longer needs use of the resources. The model will close the Tensorflow sessions when finalized, just in case the user forgets to call this method. The output of the model is a <code>Seq</code> of MLeap <code>Tensor</code> that contains the outputs in the same order specified by the given shape.</p>
<p>In order to support transformations using Tensorflow with MLeap data types, the following information is needed.</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>graph</td>
<td>The Tensorflow GraphDef saved with <strong>freeze_graph</strong></td>
</tr>
<tr>
<td>shape</td>
<td>Inputs/outputs along with non-optional type specification</td>
</tr>
<tr>
<td>nodes</td>
<td>String list of nodes to run without saving output</td>
</tr>
</tbody>
</table>
<h2 id="type-conversions">Type Conversions</h2>
<p>All basic data types have implicit conversions to Tensorflow tensors of rank 0. The <code>Tensor</code> data type in MLeap converts pretty much one-to-one with Tensorflow tensors. <code>SparseTensor</code> values are first converted to dense tensors before being passed in to Tensorflow.</p>
<p>Here is the list of currently-supported Tensorflow data types.</p>
<table>
<thead>
<tr>
<th>Tensorflow Data Type</th>
<th>MLeap Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>DT_BOOLEAN</td>
<td>BooleanType</td>
</tr>
<tr>
<td>DT_STRING</td>
<td>StringType</td>
</tr>
<tr>
<td>DT_INT32</td>
<td>IntegerType</td>
</tr>
<tr>
<td>DT_INT64</td>
<td>LongType</td>
</tr>
<tr>
<td>DT_FLOAT</td>
<td>FloatType</td>
</tr>
<tr>
<td>DT_DOUBLE</td>
<td>DoubleType</td>
</tr>
<tr>
<td><em>Tensor</em></td>
<td>TensorType</td>
</tr>
</tbody>
</table>
<p>Because the Swig wrappers do not provide support for all data types, we recommend adding in casting steps to your Tensorflow graph to integrate with MLeap.</p>
<h3 id="notes">Notes</h3>
<ol>
<li>Unsigned integer types, 8-bit, and 16-bit integers are not supported by the Swig wrappers</li>
<li>Complex types are not supported by the Swig wrappers</li>
</ol>
<h1 id="example">Example</h1>
<p>Say we have an input LeapFrame that has the following data. A scala double and a 1-dimensional double tensor (also known as a vector of doubles).</p>
<h2 id="input-leap-frame">Input Leap Frame</h2>
<h3 id="data">Data</h3>
<table>
<thead>
<tr>
<th>double1</th>
<th>tensor1</th>
</tr>
</thead>
<tbody>
<tr>
<td>3.0</td>
<td>[2.0, 1.0, 5.0, 6.0]</td>
</tr>
</tbody>
</table>
<h3 id="types">Types</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>double1</td>
<td>DoubleType</td>
</tr>
<tr>
<td>tensor1</td>
<td>TensorType(base = DoubleType, dimensions = Seq(-1))</td>
</tr>
</tbody>
</table>
<p>If we run this LeapFrame through a Tensorflow transformer that uses the <code>double1</code> value to scale the <code>tensor1</code> value and we specify we want the scaled output tensor, then the output LeapFrame will look like this:</p>
<h2 id="output-leap-frame">Output Leap Frame</h2>
<h3 id="data">Data</h3>
<table>
<thead>
<tr>
<th>double1</th>
<th>tensor1</th>
<th>raw_tf_tensors</th>
<th>output1</th>
</tr>
</thead>

<tbody>
<tr>
<td>3.0</td>
<td>[2.0, 1.0, 5.0, 6.0]</td>
<td>Seq([6.0, 3.0, 15.0])</td>
<td>[6.0, 3.0, 15.0]</td>
</tr>
</tbody>
</table>

<h3 id="types">Types</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Data Type</th>
<th>Notes</th>
</tr>
</thead>

<tbody>
<tr>
<td>double1</td>
<td>DoubleType</td>
<td></td>
</tr>

<tr>
<td>tensor1</td>
<td>TensorType(base = DoubleType, dimensions = Seq(-1))</td>
<td></td>
</tr>

<tr>
<td>raw_tf_tensors</td>
<td>ListType(base = AnyType(false))</td>
<td>Raw return types unknown, nulls are not allowed</td>
</tr>

<tr>
<td>output1</td>
<td>TensorType(base = DoubleType, dimensions = Seq(-1))</td>
<td>Underlying type known at this point, and reflected in the LeapFrame</td>
</tr>
</tbody>
</table>

<h2 id="notes">Notes</h2>
<ol>
<li>The <code>raw_tf_tensors</code> field contains an <code>AnyType</code>, which means that it is not serializable. If using Combust API servers, you will have to filter this value out when retrieving results.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Tensorflow">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="bundle-serialization.html" class="navigation navigation-next " aria-label="Next page: Bundle Serialization">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"MLeap Transformer","level":"1.6.4.1","depth":3,"next":{"title":"Bundle Serialization","level":"1.6.4.2","depth":3,"path":"integration/tensorflow/bundle-serialization.md","ref":"integration/tensorflow/bundle-serialization.md","articles":[]},"previous":{"title":"Tensorflow","level":"1.6.4","depth":2,"path":"integration/tensorflow/index.md","ref":"integration/tensorflow/index.md","articles":[{"title":"MLeap Transformer","level":"1.6.4.1","depth":3,"path":"integration/tensorflow/mleap-transformer.md","ref":"integration/tensorflow/mleap-transformer.md","articles":[]},{"title":"Bundle Serialization","level":"1.6.4.2","depth":3,"path":"integration/tensorflow/bundle-serialization.md","ref":"integration/tensorflow/bundle-serialization.md","articles":[]},{"title":"Exporting Models","level":"1.6.4.3","depth":3,"path":"integration/tensorflow/usage.md","ref":"integration/tensorflow/usage.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"integration/tensorflow/mleap-transformer.md","mtime":"2017-01-17T02:39:14.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-17T05:41:08.723Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

